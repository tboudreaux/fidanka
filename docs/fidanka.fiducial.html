<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fidanka.fiducial package &mdash; fidanka 0.5 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="fidanka.fiducial.methods package" href="fidanka.fiducial.methods.html" />
    <link rel="prev" title="fidanka.ext.src package" href="fidanka.ext.src.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            fidanka
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fidanka.html">Home</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fiducial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fidanka.fiducial.methods.html">fidanka.fiducial.methods package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fidanka.fiducial.fiducial">fidanka.fiducial.fiducial module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.MC_convex_hull_density_approximation"><code class="docutils literal notranslate"><span class="pre">MC_convex_hull_density_approximation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.approximate_fiducial_line_function"><code class="docutils literal notranslate"><span class="pre">approximate_fiducial_line_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.color_mag_from_filters"><code class="docutils literal notranslate"><span class="pre">color_mag_from_filters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.get_mag_and_color_ranges"><code class="docutils literal notranslate"><span class="pre">get_mag_and_color_ranges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.hull_density"><code class="docutils literal notranslate"><span class="pre">hull_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.instantaious_hull_density"><code class="docutils literal notranslate"><span class="pre">instantaious_hull_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.instantaious_hull_density_cpp"><code class="docutils literal notranslate"><span class="pre">instantaious_hull_density_cpp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.load_density"><code class="docutils literal notranslate"><span class="pre">load_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.measure_fiducial_lines"><code class="docutils literal notranslate"><span class="pre">measure_fiducial_lines()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.percentage_within_n_standard_deviations"><code class="docutils literal notranslate"><span class="pre">percentage_within_n_standard_deviations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.renormalize"><code class="docutils literal notranslate"><span class="pre">renormalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.ridge_bounding"><code class="docutils literal notranslate"><span class="pre">ridge_bounding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.shift_photometry_by_error"><code class="docutils literal notranslate"><span class="pre">shift_photometry_by_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducial.verticalize_CMD"><code class="docutils literal notranslate"><span class="pre">verticalize_CMD()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fidanka.fiducial.fiducialLine">fidanka.fiducial.fiducialLine module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.fiducialLine.fiducial_line"><code class="docutils literal notranslate"><span class="pre">fiducial_line</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fidanka.fiducial.fiducialLine.fiducial_line.add_measurement"><code class="docutils literal notranslate"><span class="pre">fiducial_line.add_measurement()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fidanka.fiducial.fiducialLine.fiducial_line.confidence"><code class="docutils literal notranslate"><span class="pre">fiducial_line.confidence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fidanka.fiducial.fiducialLine.fiducial_line.mean"><code class="docutils literal notranslate"><span class="pre">fiducial_line.mean</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fidanka.fiducial.fiducialLine.fiducial_line.std"><code class="docutils literal notranslate"><span class="pre">fiducial_line.std</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fidanka.fiducial.utils">fidanka.fiducial.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.GMM_component_measurment"><code class="docutils literal notranslate"><span class="pre">GMM_component_measurment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.bin_color_mag_density"><code class="docutils literal notranslate"><span class="pre">bin_color_mag_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.clean_bins"><code class="docutils literal notranslate"><span class="pre">clean_bins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.mag_bins"><code class="docutils literal notranslate"><span class="pre">mag_bins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.median_ridge_line_estimate"><code class="docutils literal notranslate"><span class="pre">median_ridge_line_estimate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.normalize_density_magBin"><code class="docutils literal notranslate"><span class="pre">normalize_density_magBin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fidanka.fiducial.utils.percentile_range"><code class="docutils literal notranslate"><span class="pre">percentile_range()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fidanka.fiducial">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.isochrone.html">Isochrone</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.isofit.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.bolometric.html">Bolometric</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.exception.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.warn.html">Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.ext.html">C-Libs</a></li>
<li class="toctree-l1"><a class="reference internal" href="fidanka.misc.html">Misc</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fidanka</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="fidanka.html">fidanka package</a></li>
      <li class="breadcrumb-item active">fidanka.fiducial package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/fidanka.fiducial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="fidanka-fiducial-package">
<h1>fidanka.fiducial package<a class="headerlink" href="#fidanka-fiducial-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fidanka.fiducial.methods.html">fidanka.fiducial.methods package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fidanka.fiducial.methods.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="fidanka.fiducial.methods.html#module-fidanka.fiducial.methods.mc">fidanka.fiducial.methods.mc module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fidanka.fiducial.methods.html#fidanka.fiducial.methods.mc.log_likelihood"><code class="docutils literal notranslate"><span class="pre">log_likelihood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="fidanka.fiducial.methods.html#fidanka.fiducial.methods.mc.log_prior"><code class="docutils literal notranslate"><span class="pre">log_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="fidanka.fiducial.methods.html#fidanka.fiducial.methods.mc.log_probability"><code class="docutils literal notranslate"><span class="pre">log_probability()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="fidanka.fiducial.methods.html#fidanka.fiducial.methods.mc.plm"><code class="docutils literal notranslate"><span class="pre">plm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fidanka.fiducial.methods.html#module-fidanka.fiducial.methods">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-fidanka.fiducial.fiducial">
<span id="fidanka-fiducial-fiducial-module"></span><h2>fidanka.fiducial.fiducial module<a class="headerlink" href="#module-fidanka.fiducial.fiducial" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.MC_convex_hull_density_approximation">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">MC_convex_hull_density_approximation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverseFilterOrder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcruns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convexHullPoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.MC_convex_hull_density_approximation" title="Permalink to this definition"></a></dt>
<dd><p>Compute the density at each point in a CMD accounting for uncertainty
in data. Uncertainty is accounted for through monte carlo sampleling wherin
all data is shifted around based on individual uncertainties, the density
is calculate using the methods described in the hull_density function, and
then process is repeated mcruns times. After each repetion the density is
averaged with a running density. The final reported density at each point
is the average density at each point with mcruns shifts of the data around
based on its photometric uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – First filter, will be A in A-B color</p></li>
<li><p><strong>filter2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Second filter, will be B in A-B color</p></li>
<li><p><strong>error1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter1.</p></li>
<li><p><strong>error2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter2.</p></li>
<li><p><strong>reverseFilterOrder</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag to determine which filter is used as the magnitude. If
reverseFilterOrder is false then filter1 is is the magnitude. If
reverseFilterOrder is True then filter2 is the magnitude</p></li>
<li><p><strong>mcruns</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of monte carlo runs to use when calculating the density. Note
that increasing this will linearlly slow down your code. If
mcruns is set to 1 then the density will be calculated without
accounting for uncertainty.</p></li>
<li><p><strong>convexHullPoints</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of closest points to considered when finding the convex hull
used to define the area in the instantaious_hull_density function.</p></li>
<li><p><strong>pbar</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Flag controlling whether a progress bar is written to standard output.
This will marginally slow down your code; however, its a very small
effect and I generally find it helpful to have this turned on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>density</strong> – 1D array of density at each point in the color magnitude diagram.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray[float64]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Given some pandas dataframe which contains photometric data called
“Photometry” the density of the F275W-F814W CMD could be computed</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fidanka.fiducial</span> <span class="kn">import</span> <span class="n">MC_convex_hull_density_approximation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">Photometry</span><span class="p">[</span><span class="s2">&quot;F275W&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">Photometry</span><span class="p">[</span><span class="s2">&quot;F814W&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">MC_convex_hull_density_approximation</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">reverseFilterOrder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.approximate_fiducial_line_function">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">approximate_fiducial_line_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">31.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">68.97</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowMax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.approximate_fiducial_line_function" title="Permalink to this definition"></a></dt>
<dd><p>Get an approximate fiducua line from a CMD using the basic ridge bounding
algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Color of each target in a CMD of shape m.</p></li>
<li><p><strong>mag</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Magnitude of each target in a CMD of shape m.</p></li>
<li><p><strong>density</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Density at each point in a CMD of shape m.</p></li>
<li><p><strong>binSize</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>default='adaptive'</em>) – Spacing between each left bin edge to each right bin edge. Default
is ‘adaptive’ which will generate bins adaptivly in order to
maintain uniform counting statistics.</p></li>
<li><p><strong>percLow</strong> (<em>float</em><em>, </em><em>default=1</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em><em>, </em><em>default=99</em>) – Upper bound percentile to base range on</p></li>
<li><p><strong>allowMax</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true then the ridge bounding algorithm will allow the maximum
value in the color distribution to be used as a fiducial point if
the gaussian fitting fails. If false and if the gaussian curve fit
failes then a nan will be used. (depricated, will be removed in
a latter version)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ff</strong> – 1d linear interpolation between the calculate fiducial points
using the ridge bounding method. ff is parmeterized as a function
of magnitude (so as to make it a one-to-one function)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.color_mag_from_filters">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">color_mag_from_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverseFilterOrder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.color_mag_from_filters" title="Permalink to this definition"></a></dt>
<dd><p>Given two filters and the a flag saying which one to use as the magnitude
return the color and magnitude arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – First filter, will be A in A-B color</p></li>
<li><p><strong>filter2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Second filter, will be B in A-B color</p></li>
<li><p><strong>reverseFilterOrder</strong> (<em>bool</em>) – Flag to determine which filter is used as the magnitude. If
reverseFilterOrder is false then filter1 is is the magnitude. If
reverseFilterOrder is True then filter2 is the magnitude</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Where color and magnitude are of type
Union[ndarray[float64], pd.Series] and have the same shape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[color, magnitude]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.get_mag_and_color_ranges">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">get_mag_and_color_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.get_mag_and_color_ranges" title="Permalink to this definition"></a></dt>
<dd><p>Find the ranges of both color and magnitude between their percLow and
percHigh percentiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – 1D array of color of shape m</p></li>
<li><p><strong>mag</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – 1D array of magnitude of shape m</p></li>
<li><p><strong>percLow</strong> (<em>float</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em>) – Upper bound percentile to base range on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>colorRange</strong> (<em>Tuple[float, float]</em>) – Range of color between its percLow and percHigh percentiles</p></li>
<li><p><strong>magRange</strong> (<em>Tuple[float, float]</em>) – Range of mag between its percLow and percHigh percentiles</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.hull_density">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">hull_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.hull_density" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the number density at each point (i, j) for i, j in X, Y using
the instantaious_hull_density function. X and Y must have the same shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – x values of dataset</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – y values of dataset</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of closest points to considered when finding the convex hull
used to define the area in the instantaious_hull_density function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>density</strong> – 1D array of density. If len(X) == len(Y)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray[float64]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Given some array color and magnitude, defining some CMD for a globular
clusters then you could find the approximate density at each target</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fidanka.fiducial</span> <span class="kn">import</span> <span class="n">hull_density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">hull_density</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this is not a very fast algorithm as its complexity scales
like O(n^2). For each data point the distance to every other data point
must be calculated.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.instantaious_hull_density">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">instantaious_hull_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">r0:</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[[&lt;class</span> <span class="pre">'numpy.float64'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float64'&gt;]]],</span> <span class="pre">ri:</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[[numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.float64]],</span> <span class="pre">numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.float64]]]]],</span> <span class="pre">n:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ConvexHull</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.instantaious_hull_density" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the density at a given point in a dataset in a way which keeps
the counting statistics for each density calculation uniform. In order to
do this four steps.</p>
<blockquote>
<div><p>1. Calculate the euclidian distance between the point in question (ri)
and every other point (r0[j]) in the data set.
2. Partition the 50 smallest elements from the calculated distance array
3. Use those indicies to select the 50 points from r0 which are the
closest to ri
4. Find the convex hull of those 50 (it will be 50 not 51 as r0 is
assumed to be a member of ri so there will always be at least one
distance of 0 in the distance array which is the self distance)
5. Define and return the area as the number of points (n) / the area of
the convex hull</p>
</div></blockquote>
<p>This method dynamically varies the area considered when calculating the
density in order to maintain a fixed number of samples per area bin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r0</strong> (<em>ndarray</em><em>[</em><em>[</em><em>float64</em><em>, </em><em>float64</em><em>]</em><em>]</em>) – x, y coordinates of the point where you wish to calculate the
density of. Assumed to be a member of ri. If this is not a member
of ri the algorithm should still work under the constraint that the
data is well distributed in all directions around r0, otherwise the
area calculation could be off.</p></li>
<li><p><strong>ri</strong> (<em>ndarray</em><em>[</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>]</em><em>]</em>) – x,y coordinates of all data points. This should have the shape
(n, 2) where n is the numbe of data points</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of closest points to considered when finding the convex hull
used to define the area.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>density</strong> (<em>float64</em>) – The approximate density at ri embeded within the r0 data field</p></li>
<li><p><strong>hull</strong> (<em>ConvexHull</em>) – The fully computed convex hull of the n closest points to ri within
the ri data field. Computed by scipy.spatial.ConvexHull (qhull)</p></li>
<li><p><strong>partition</strong> (<em>ndarray[int]</em>) – The indicies of the n closest points to ri within the ri data field.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.instantaious_hull_density_cpp">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">instantaious_hull_density_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">r0:</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[[&lt;class</span> <span class="pre">'numpy.float64'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float64'&gt;]]],</span> <span class="pre">ri:</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[[numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.float64]],</span> <span class="pre">numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.float64]]]]],</span> <span class="pre">n:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ConvexHull</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.instantaious_hull_density_cpp" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the density at a given point in a dataset in a way which keeps
the counting statistics for each density calculation uniform. In order to
do this four steps.</p>
<blockquote>
<div><p>1. Calculate the euclidian distance between the point in question (ri)
and every other point (r0[j]) in the data set.
2. Partition the 50 smallest elements from the calculated distance array
3. Use those indicies to select the 50 points from r0 which are the
closest to ri
4. Find the convex hull of those 50 (it will be 50 not 51 as r0 is
assumed to be a member of ri so there will always be at least one
distance of 0 in the distance array which is the self distance)
5. Define and return the area as the number of points (n) / the area of
the convex hull</p>
</div></blockquote>
<p>This method dynamically varies the area considered when calculating the
density in order to maintain a fixed number of samples per area bin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r0</strong> (<em>ndarray</em><em>[</em><em>[</em><em>float64</em><em>, </em><em>float64</em><em>]</em><em>]</em>) – x, y coordinates of the point where you wish to calculate the
density of. Assumed to be a member of ri. If this is not a member
of ri the algorithm should still work under the constraint that the
data is well distributed in all directions around r0, otherwise the
area calculation could be off.</p></li>
<li><p><strong>ri</strong> (<em>ndarray</em><em>[</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>]</em><em>]</em>) – x,y coordinates of all data points. This should have the shape
(n, 2) where n is the numbe of data points</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of closest points to considered when finding the convex hull
used to define the area.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>density</strong> (<em>float64</em>) – The approximate density at ri embeded within the r0 data field</p></li>
<li><p><strong>hull</strong> (<em>ConvexHull</em>) – The fully computed convex hull of the n closest points to ri within
the ri data field. Computed by scipy.spatial.ConvexHull (qhull)</p></li>
<li><p><strong>partition</strong> (<em>ndarray[int]</em>) – The indicies of the n closest points to ri within the ri data field.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.load_density">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">load_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cacheDensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cacheDensityName</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverseFilterOrder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convexHullPoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.load_density" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.measure_fiducial_lines">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">measure_fiducial_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverseFilterOrder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcruns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convexHullPoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uniformCS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cacheDensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cacheDensityName</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'CMDDensity.npz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piecewise_linear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.measure_fiducial_lines" title="Permalink to this definition"></a></dt>
<dd><p>Measure the fiducial lines in a CMD. This function will take in two filters
and their associated uncertainties and calculate the fiducial lines in the
CMD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – First filter, will be A in A-B color</p></li>
<li><p><strong>filter2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Second filter, will be B in A-B color</p></li>
<li><p><strong>error1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter1.</p></li>
<li><p><strong>error2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter2.</p></li>
<li><p><strong>reverseFilterOrder</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag to determine which filter is used as the magnitude. If
reverseFilterOrder is false then filter1 is is the magnitude. If
reverseFilterOrder is True then filter2 is the magnitude</p></li>
<li><p><strong>mcruns</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of monte carlo runs to use when calculating the density. Note
that increasing this will linearlly slow down your code. If mcruns
is set to 1 then the density will be calculated using the
nominal values (no monte carlo).</p></li>
<li><p><strong>convexHullPoints</strong> (<em>int</em><em>, </em><em>default=100</em>) – Number of closest points to considered when finding the convex hull
used to define the area in the instantaious_hull_density function.</p></li>
<li><p><strong>binSize</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>default=adaptive</em>) – Bin size to use when applying the spline smoothing algorithm. The
default is adaptive. It can also be set as fixed values.</p></li>
<li><p><strong>percLow</strong> (<em>float</em><em>, </em><em>default=1</em>) – Overall lower percentile bound to cut magnitude on.</p></li>
<li><p><strong>percHigh</strong> (<em>float</em><em>, </em><em>default=99</em>) – Overall upper percentile bound to cut magnitude on.</p></li>
<li><p><strong>splineSmoothMin</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Miniumum smoothing factor to use. Generally this should be small
but non zero (0.1 has worked well for me)</p></li>
<li><p><strong>splineSmoothMax</strong> (<em>float</em><em>, </em><em>default=1</em>) – Maximum smoothing factor to use. I find that its not good to push
this much past 1</p></li>
<li><p><strong>splineSmoothN</strong> (<em>int</em><em>, </em><em>default=200</em>) – Overall number of splines to fit. The spline fitting routines in
scipy, which this function makes use of, are well optimized so
you can push this pretty high without too many preformance issues.
I find that a value of 100-200 works well. However, this will depend
on your specific density profile.</p></li>
<li><p><strong>colorSigCut</strong> (<em>float</em><em>, </em><em>default=5</em>) – Sigma distance to cut color based on</p></li>
<li><p><strong>pbar</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Flag controlling whether a progress bar is written to standard output.
This will marginally slow down your code; however, its a very small
effect and I generally find it helpful to have this turned on.</p></li>
<li><p><strong>allowMax</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true then the ridge bounding algorithm will allow the maximum
value in the color distribution to be used as a fiducial point if
the gaussian fitting fails. If false and if the gaussian curve fit
failes then a nan will be used.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag to control whether or not to print out information about the
fiducial line fitting process. This is useful for debugging.</p></li>
<li><p><strong>cacheDensity</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag to control whether or not to cache the density calculation.
This can be useful if you are going to be calling this function
multiple times with the same data. However, if you are going to be
calling this function multiple times with different data then
you should not use this flag.</p></li>
<li><p><strong>cacheDensityName</strong> (<em>str</em><em>, </em><em>default='CMDDensity.npz'</em>) – Name of the file to use to cache the density calculation. This is
only used if cacheDensity is True. If the file does not
exist then it will be created. If the file does exist then it will
be loaded.</p></li>
<li><p><strong>minMagCut</strong> (<em>float</em><em>, </em><em>default=-np.inf</em>) – Minimum magnitude to cut on. This is useful if you want to cut out
the RGB. Note that this is applied before the overall magnitude
cut (percLow and percHigh) is applied.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default=&quot;waveform&quot;</em>) – Method to use to calculate the density. Currently the spline and
waveform methods are supported. The waveform method is the default
while the spline method is the old method used. The spline method
is included for backwards compatibility but may be more robust in
some cases. Waveform should generally result in beter fiducial
lines as it considers more than one magnitude bin at a time. It
should also be faster than the spline method generally.</p></li>
<li><p><strong>uni_density</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag controls whether to change the sampling method to achieve a roughly
uniform distribution of numbers of data points in filter1 magnitude</p></li>
<li><p><strong>max_Num_bin</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>default=False</em>) – Control the maximum number of magnitude bins</p></li>
<li><p><strong>binSize_min</strong> (<em>float</em><em>, </em><em>default = 0.1</em>) – The minimum size of mag bin. Set to 0.1 to avoid overfitting Main sequence</p></li>
<li><p><strong>piecewise_linear</strong> (<em>Union</em><em>[</em><em>bool</em><em>,</em><em>FARRAY_1D</em><em>]</em><em>, </em><em>default = False</em>) – Introduce a new method of calulating the fiduial line using mcmc to find the
best-fit piecewise linear function for the data. Can be turned on when Hull
density method struggles in the low density region. Takes [nwalkers, iter] if
not set as False</p></li>
<li><p><strong>nPops</strong> (<em>int</em><em>, </em><em>default=2</em>) – Number of populations to fit using the gaussian mixture modeling method.</p></li>
<li><p><strong>targetStat</strong> (<em>int</em><em>, </em><em>default=250</em>) – Number of points per bin to aim to when using uniformCS binning algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fiducial</strong> – Ridge line fit to a1 and a2. ridgeLine[0, :] gives the coordinates
of the ridge line along the a1 axis, while ridgeLine[1, :] gives
the coordinates of the ridgeLine along the a2 axis (these
are the infered centers points of the bins)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray[[ndarray[float64], ndarray[float64]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.percentage_within_n_standard_deviations">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">percentage_within_n_standard_deviations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.fiducial.percentage_within_n_standard_deviations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.renormalize">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">renormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.renormalize" title="Permalink to this definition"></a></dt>
<dd><p>Resample the data in the first place to ensure new data has roughly uniform
distribution in filter1 magnitude. To achieve that, data will be segmented by
filter1 magnitude. The uniformity is achieved by over sample low density region
and undersample high density region.
This function is only used when uni_density = True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – First filter, will be A in A-B color</p></li>
<li><p><strong>filter2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Second filter, will be B in A-B color</p></li>
<li><p><strong>error1</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter1.</p></li>
<li><p><strong>error2</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry from filter2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>filter1_renomalized</strong> (<em>Union[ndarray[float64], pd.Series]</em>) – Renomalized first filter, will be A in A-B color</p></li>
<li><p><strong>filter2_renomalized</strong> (<em>Union[ndarray[float64], pd.Series]</em>) – Renomalized second filter, will be B in A-B color</p></li>
<li><p><strong>error1_renomalized</strong> (<em>Union[ndarray[float64], pd.Series]</em>) – One sigma uncertainties in Photometry from renomalized filter1.</p></li>
<li><p><strong>error2_renomalized</strong> (<em>Union[ndarray[float64], pd.Series]</em>) – One sigma uncertainties in Photometry from renomalized filter2.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.ridge_bounding">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">ridge_bounding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsLeft</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsRight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histBins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowMax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.ridge_bounding" title="Permalink to this definition"></a></dt>
<dd><p>Find a ridge line for some data x=a1, y=a2 binned along a2 in bins whos
left (bottom) edges are defined in binsLeft.</p>
<p>This algorithm works by slicing a1 and a2 by which points fall within each
bin then fitting a unimodal normal distribution to a histogram of those
point along the a1 axis.</p>
<p>Addotionally the 4th and 96th percentiles along the a1 axis are returned for
each bin in a2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a1</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Axis 1, x coordinates of each data point</p></li>
<li><p><strong>a2</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Axis 2, y coordinates of each data point</p></li>
<li><p><strong>binsLeft</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – left (bottom) edges of bins along a2 axis.</p></li>
<li><p><strong>binsRight</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Right (bottom) edges of bins along a2 axis.</p></li>
<li><p><strong>histBins</strong> (<em>Union</em><em>[</em><em>int</em><em>,</em><em>str</em><em>]</em><em>, </em><em>default=50</em>) – Number of bins to use when generating the histogram. See numpy
histogram documentation for valid stings to use.</p></li>
<li><p><strong>allowMax</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true, if the fitting fails for a given bin then the bin will be
filled with the max value of the histogram. If false, the bin will
be filled with nans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ridgeLine</strong> – Ridge line fit to a1 and a2. ridgeLine[0, :] gives the coordinates
of the ridge line along the a1 axis, while ridgeLine[1, :] gives
the coordinates of the ridgeLine along the a2 axis (these
are the infered centers points of the bins)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray[[ndarray[float64], ndarray[float64]]]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Given some array color and magnitude, defining some CMD for a globular
clusters then you could find an approximate ridge line to that CMD using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fidanka.fiducial</span> <span class="kn">import</span> <span class="n">ridge_bounding</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magRange</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">magnitude</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">magnitude</span><span class="p">,</span> <span class="mi">95</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binsLeft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">magRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">magRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ridgeLine</span> <span class="o">=</span> <span class="n">ridge_bounding</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">binsLeft</span><span class="p">)</span>
</pre></div>
</div>
<p>Note how the mag range does not include all the data. This is to avoid
fitting issuse at in the lowest counting statistics portions of the CMD.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.shift_photometry_by_error">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">shift_photometry_by_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseSampling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.shift_photometry_by_error" title="Permalink to this definition"></a></dt>
<dd><p>Shift each point, p_i, in phot by some amount sampled from a normal
distribution with standard deviation equal to its associated uncertainty,
e_i, in err. Phot and Err must both be 1D and must both be the same shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phot</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Nominal values of Photometry (single filter)</p></li>
<li><p><strong>err</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – One sigma uncertainties in Photometry.</p></li>
<li><p><strong>baseSampling</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Random samples from a normal distribution with mu = 0 and sig = 1
which will be rescaled to the correct standard deviation and
used to shift the photometry by the error. Must have the same
shape as filter1 and filter2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>shiftedPhot</strong> – Array of the same shape as phot but with each point shifted
by some amount sampled from a normal distribution with standard
deviation equal to that of the uncertainty of each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray[float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducial.verticalize_CMD">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducial.</span></span><span class="sig-name descname"><span class="pre">verticalize_CMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowMax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.fiducial.verticalize_CMD" title="Permalink to this definition"></a></dt>
<dd><p>Given some CMD fit an approximate fiducual line and use that to verticalize
the CMD along the main sequence and the RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Color of each target in a CMD of shape m.</p></li>
<li><p><strong>mag</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Magnitude of each target in a CMD of shape m.</p></li>
<li><p><strong>density</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – Density at each point in a CMD of shape m.</p></li>
<li><p><strong>binSize</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>default='adaptive'</em>) – Spacing between each left bin edge to each right bin edge. Default
is ‘adaptive’ which will generate bins adaptivly in order to
maintain uniform counting statistics.</p></li>
<li><p><strong>percLow</strong> (<em>float</em><em>, </em><em>default=1</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em><em>, </em><em>default=99</em>) – Upper bound percentile to base range on</p></li>
<li><p><strong>allowMax</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true then the ridge bounding algorithm will allow the maximum
value in the color distribution to be used as a fiducial point if
the gaussian fitting fails. If false and if the gaussian curve fit
failes then a nan will be used. (depricated, will be removed in a
future version)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vColor</strong> (<em>ndarray[float64]</em>) – Verticalized color, indexed the same as color and mag</p></li>
<li><p><strong>ff</strong> (<em>Callable</em>) – 1d linear interpolation between the calculate fiducial points
using the ridge bounding method. ff is parmeterized as a function
of magnitude (so as to make it a one-to-one function)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fidanka.fiducial.fiducialLine">
<span id="fidanka-fiducial-fiducialline-module"></span><h2>fidanka.fiducial.fiducialLine module<a class="headerlink" href="#module-fidanka.fiducial.fiducialLine" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducialLine.fiducial_line">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.fiducialLine.</span></span><span class="sig-name descname"><span class="pre">fiducial_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.fiducialLine.fiducial_line" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducialLine.fiducial_line.add_measurement">
<span class="sig-name descname"><span class="pre">add_measurement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.fiducialLine.fiducial_line.add_measurement" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducialLine.fiducial_line.confidence">
<span class="sig-name descname"><span class="pre">confidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.fiducialLine.fiducial_line.confidence" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the upper and lower bound confidence intervals for the mean
fiducial line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>float</em>) – The percentile of the confidence interval. (0 &lt; p &lt; 1)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lower</strong> (<em>ndarray</em>) – The lower bound confidence interval for the mean fiducial line.</p></li>
<li><p><strong>upper</strong> (<em>ndarray</em>) – The upper bound confidence interval for the mean fiducial line.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fiducialLine</span> <span class="kn">import</span> <span class="n">fiducial_line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">fiducial_line</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">add_measurement</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">add_measurement</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">add_measurement</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">confidence</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducialLine.fiducial_line.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#fidanka.fiducial.fiducialLine.fiducial_line.mean" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fidanka.fiducial.fiducialLine.fiducial_line.std">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">std</span></span><a class="headerlink" href="#fidanka.fiducial.fiducialLine.fiducial_line.std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fidanka.fiducial.utils">
<span id="fidanka-fiducial-utils-module"></span><h2>fidanka.fiducial.utils module<a class="headerlink" href="#module-fidanka.fiducial.utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.GMM_component_measurment">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">GMM_component_measurment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.utils.GMM_component_measurment" title="Permalink to this definition"></a></dt>
<dd><p>Fit a Gaussian Mixture Model to each bin of a CMD and return the mean of
each component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xB</strong> (<em>List</em><em>[</em><em>FARRAY_1D</em><em>]</em>) – List of color bins.</p></li>
<li><p><strong>yB</strong> (<em>List</em><em>[</em><em>FARRAY_1D</em><em>]</em>) – List of magnitude bins.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default=50</em>) – Number of components to fit to each bin.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gmm_means</strong> – List of the means of the Gaussian Mixture Models fit to each bin.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FARRAY_2D_2C</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.bin_color_mag_density">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">bin_color_mag_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uniformCS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_Num_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.utils.bin_color_mag_density" title="Permalink to this definition"></a></dt>
<dd><p>Use the bin edges from mag_bins to split the color, mag, and density arrays
into lists of arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<em>np.ndarray</em><em>[</em><em>float64</em><em>]</em>) – 1D array of color of shape m for the stars in the CMD</p></li>
<li><p><strong>mag</strong> (<em>np.ndarray</em><em>[</em><em>float64</em><em>]</em>) – 1D array of magnitude of shape m for the stars in the CMD</p></li>
<li><p><strong>density</strong> (<em>np.ndarray</em><em>[</em><em>float64</em><em>]</em>) – 1D array of density of shape m for the stars in the CMD</p></li>
<li><p><strong>percLow</strong> (<em>float</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em>) – Upper bound percentile to base range on</p></li>
<li><p><strong>binSize</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>) – Size of the bins to use. If ‘adaptive’ will attempt to keep
counting statistics the same throughout.</p></li>
<li><p><strong>max_Num_bin</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>int</em><em>]</em>) – False or <cite>0</cite> will not limit the number of bins. Any other integer
will limit the number of bins to that number.</p></li>
<li><p><strong>binSize_min</strong> (<em>float</em>) – Minimum bin size to use when using adaptive binning</p></li>
<li><p><strong>targetStat</strong> (<em>int</em><em>, </em><em>default=1000</em>) – Target number of stars per bin when using uniformCS binning</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>colorBins</strong> (<em>List[np.ndarray[float64]]</em>) – List of arrays of color of shape m for the stars in the CMD</p></li>
<li><p><strong>magBins</strong> (<em>List[np.ndarray[float64]]</em>) – List of arrays of magnitude of shape m for the stars in the CMD</p></li>
<li><p><strong>densityBins</strong> (<em>List[np.ndarray[float64]]</em>) – List of arrays of density of shape m for the stars in the CMD</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.clean_bins">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">clean_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colorBins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magBins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densityBins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.utils.clean_bins" title="Permalink to this definition"></a></dt>
<dd><p>Remove high sigma outliers from the bins. Repeat the process iterativly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colorBins</strong> (<em>List</em><em>[</em><em>FARRAY_1D</em><em>]</em>) – List of color bins.</p></li>
<li><p><strong>magBins</strong> (<em>List</em><em>[</em><em>FARRAY_1D</em><em>]</em>) – List of magnitude bins.</p></li>
<li><p><strong>densityBins</strong> (<em>List</em><em>[</em><em>FARRAY_1D</em><em>]</em>) – List of density bins.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>default=5</em>) – Sigma value to use for the outlier removal.</p></li>
<li><p><strong>iterations</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of iterations to perform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cleaned color, magnitude and density bins.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[FARRAY_1D], List[FARRAY_1D], List[FARRAY_1D]]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">colorBins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magBins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">densityBins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean_bins</span><span class="p">(</span><span class="n">colorBins</span><span class="p">,</span> <span class="n">magBins</span><span class="p">,</span> <span class="n">densityBins</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.mag_bins">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">mag_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxNumBins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSizeMin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.utils.mag_bins" title="Permalink to this definition"></a></dt>
<dd><p>Find the left and right edges of bins in magnitude space between magnitudes
percLow and percHigh percentiles with a bin size of binSize. Find suitable
binsize if choose to use adapative bin size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – 1D array of magnitude of shape m</p></li>
<li><p><strong>percLow</strong> (<em>float</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em>) – Upper bound percentile to base range on</p></li>
<li><p><strong>binSize</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>) – Spacing between each left bin edge to each right bin edge. If
‘adaptive’ will attempt to keep match the target number of bins
over the range. If binSize is set to uniformCS then the bin size
will be adjusted so that the counting statistics are roughly the
same in each bin.</p></li>
<li><p><strong>maxNumBins</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>default=False</em>) – maximum number of bins</p></li>
<li><p><strong>binSizeMin</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Minimum bin size to use when using adaptive binning</p></li>
<li><p><strong>targetStat</strong> (<em>int</em><em>, </em><em>default=100</em>) – Target number of stars in each bin when using uniformCS binning</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>binsLeft</strong> (<em>ndarray[float64]</em>) – left edges of bins in magnitude space</p></li>
<li><p><strong>binsRight</strong> (<em>ndarray[float64]</em>) – right edges of bins in magnitude space</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.median_ridge_line_estimate">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">median_ridge_line_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniformCS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_Num_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaCut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaningIterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normBinSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetStat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fidanka.fiducial.utils.median_ridge_line_estimate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.normalize_density_magBin">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_density_magBin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.utils.normalize_density_magBin" title="Permalink to this definition"></a></dt>
<dd><p>Normalize the density of each point on a CMD by the mean of the densities
within binSize of the point. This allows densities to be compared between
the RGB and MS more easily.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<em>FARRAY_1D</em>) – Colors of stars in the CMD.</p></li>
<li><p><strong>mag</strong> (<em>FARRAY_1D</em>) – Magnitudes of stars in the CMD.</p></li>
<li><p><strong>density</strong> (<em>FARRAY_1D</em>) – Density of stars in the CMDs.</p></li>
<li><p><strong>binSize</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Size of the bins to use for the normalization.</p></li>
<li><p><strong>pbar</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Show a progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>normDensity</strong> – Normalized density of stars in the CMDs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FARRAY_1D</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fidanka.fiducial.utils.percentile_range">
<span class="sig-prename descclassname"><span class="pre">fidanka.fiducial.utils.</span></span><span class="sig-name descname"><span class="pre">percentile_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percLow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percHigh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fidanka.fiducial.utils.percentile_range" title="Permalink to this definition"></a></dt>
<dd><p>Extract ranges from an array based on requested percentiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>Union</em><em>[</em><em>ndarray</em><em>[</em><em>float64</em><em>]</em><em>, </em><em>pd.Series</em><em>]</em>) – Array to extract range from</p></li>
<li><p><strong>percLow</strong> (<em>float</em>) – Lower bound percentile to base range on</p></li>
<li><p><strong>percHigh</strong> (<em>float</em>) – Upper bound percentile to base range on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>xRange</strong> – range of X between its percLow and percHigh percentiles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fidanka.fiducial">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fidanka.fiducial" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fidanka.ext.src.html" class="btn btn-neutral float-left" title="fidanka.ext.src package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fidanka.fiducial.methods.html" class="btn btn-neutral float-right" title="fidanka.fiducial.methods package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Emily M. Boudreaux.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
